<!doctype html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    
    <title>Visualizando datos</title>
    
    <meta name="description" content="Visualizando datos con R">
    <meta name="author" content="JJ Merelo">
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
    
    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/extra.css">
    <link rel="stylesheet" href="css/theme/beige.css" id="theme">

    <!-- plotly -->

    <script src="lib/htmlwidgets-0.6/htmlwidgets.js"></script>
    <script src="lib/plotlyjs-1.6.1/plotly-latest.min.js"></script>
    <script src="lib/plotly-binding-3.4.3/plotly.js"></script>

    <!-- Code syntax highlighting -->
    <link rel="stylesheet" href="lib/css/zenburn.css">
    
    <!-- Printing and PDF exports -->
    <script>
     var link = document.createElement( 'link' );
     link.rel = 'stylesheet';
     link.type = 'text/css';
     link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
     document.getElementsByTagName( 'head' )[0].appendChild( link );
    </script>
    
    <!--[if lt IE 9]>
    <script src="lib/js/html5shiv.js"></script>
    <![endif]-->

    <script type="application/json" data-for="htmlwidget-9129">{"x":{"data":[{"x":[16],"y":[5],"text":["Votos: 5<br>Votos: 5"],"type":"bar","marker":{"autocolorscale":false,"color":"rgb(19,43,67)","line":{"width":1.88976377952756,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","name":""},{"x":[15],"y":[23],"text":["Votos: 23<br>Votos: 23"],"type":"bar","marker":{"autocolorscale":false,"color":"rgb(31,67,100)","line":{"width":1.88976377952756,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","name":""},{"x":[14],"y":[26],"text":["Votos: 26<br>Votos: 26"],"type":"bar","marker":{"autocolorscale":false,"color":"rgb(34,72,106)","line":{"width":1.88976377952756,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","name":""},{"x":[13],"y":[34],"text":["Votos: 34<br>Votos: 34"],"type":"bar","marker":{"autocolorscale":false,"color":"rgb(39,83,121)","line":{"width":1.88976377952756,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","name":""},{"x":[12],"y":[37],"text":["Votos: 37<br>Votos: 37"],"type":"bar","marker":{"autocolorscale":false,"color":"rgb(41,87,127)","line":{"width":1.88976377952756,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","name":""},{"x":[9,10,11],"y":[38,38,38],"text":["Votos: 38<br>Votos: 38","Votos: 38<br>Votos: 38","Votos: 38<br>Votos: 38"],"type":"bar","marker":{"autocolorscale":false,"color":"rgb(42,89,129)","line":{"width":1.88976377952756,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","name":""},{"x":[8],"y":[40],"text":["Votos: 40<br>Votos: 40"],"type":"bar","marker":{"autocolorscale":false,"color":"rgb(44,92,133)","line":{"width":1.88976377952756,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","name":""},{"x":[7],"y":[45],"text":["Votos: 45<br>Votos: 45"],"type":"bar","marker":{"autocolorscale":false,"color":"rgb(47,99,143)","line":{"width":1.88976377952756,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","name":""},{"x":[6],"y":[51],"text":["Votos: 51<br>Votos: 51"],"type":"bar","marker":{"autocolorscale":false,"color":"rgb(52,108,155)","line":{"width":1.88976377952756,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","name":""},{"x":[4,5],"y":[58,58],"text":["Votos: 58<br>Votos: 58","Votos: 58<br>Votos: 58"],"type":"bar","marker":{"autocolorscale":false,"color":"rgb(57,119,169)","line":{"width":1.88976377952756,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","name":""},{"x":[3],"y":[60],"text":["Votos: 60<br>Votos: 60"],"type":"bar","marker":{"autocolorscale":false,"color":"rgb(59,122,174)","line":{"width":1.88976377952756,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","name":""},{"x":[2],"y":[71],"text":["Votos: 71<br>Votos: 71"],"type":"bar","marker":{"autocolorscale":false,"color":"rgb(67,140,197)","line":{"width":1.88976377952756,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","name":""},{"x":[1],"y":[94],"text":["Votos: 94<br>Votos: 94"],"type":"bar","marker":{"autocolorscale":false,"color":"rgb(86,177,247)","line":{"width":1.88976377952756,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","name":""},{"x":[0.4,16.6],"y":[-4.7,98.7],"name":"99_5e929470a1eaee5d6329426731ca8ee3","type":"scatter","mode":"markers","opacity":0,"hoverinfo":"none","showlegend":false,"marker":{"color":[0,1],"colorscale":[[0,"#132B43"],[0.0588235294117647,"#16324C"],[0.117647058823529,"#1A3855"],[0.176470588235294,"#1D3F5E"],[0.235294117647059,"#214668"],[0.294117647058824,"#244D71"],[0.352941176470588,"#28557B"],[0.411764705882353,"#2C5C85"],[0.470588235294118,"#2F638F"],[0.529411764705882,"#336B99"],[0.588235294117647,"#3773A3"],[0.647058823529412,"#3B7AAE"],[0.705882352941177,"#3F82B8"],[0.764705882352941,"#438AC3"],[0.823529411764706,"#4792CD"],[0.882352941176471,"#4B9AD8"],[0.941176470588235,"#4FA2E3"],[1,"#53AAEE"]],"colorbar":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"thickness":23.04,"title":"Votos","titlefont":{"color":"rgb(0,0,0)","family":"serif","size":14.6118721461187},"tickmode":"array","ticktext":["25","50","75"],"tickvals":[0.235294117647059,0.529411764705882,0.823529411764706],"tickfont":{"color":"rgb(0,0,0)","family":"serif","size":11.689497716895},"ticklen":2,"len":0.5}}}],"layout":{"margin":{"b":206.75799086758,"l":37.2602739726027,"t":23.3059360730594,"r":7.30593607305936},"font":{"color":"rgb(0,0,0)","family":"serif","size":14.6118721461187},"xaxis":{"type":"linear","autorange":false,"tickmode":"array","range":[0.4,16.6],"ticktext":["JOAQUÍN FERNÁNDEZ VALDIVIA","RAFAEL MOLINA SORIANO","PATRICIA PADEREWSKI RODRÍGUEZ","JULIO ORTEGA LOPERA","ÓSCAR CORDÓN GARCÍA","MANUEL RODRÍGUEZ ÁLVAREZ","JESÚS BANQUERI OZÁEZ","PEDRO ÁNGEL CASTILLO VALDIVIESO","BUENAVENTURA CLARES RODRÍGUEZ","IGNACIO JOSÉ BLANCO MEDINA","WALDO FAJARDO CONTRERAS","JORGE CASILLAS BARRANQUERO","JOSÉ CARLOS SEGURA LUNA","ANTONIO MIGUEL PEINADO HERREROS","MIGUEL DELGADO CALVO-FLORES","RODRIGO MARTÍN ROJAS"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],"ticks":"outside","tickcolor":"rgb(0,0,0)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgb(0,0,0)","family":"serif","size":11.689497716895},"tickangle":-90,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"domain":[0,1],"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","hoverformat":".2f"},"annotations":[{"text":"reorder(Nombre, -Votos)","x":0.5,"y":-0.501126241076836,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgb(0,0,0)","family":"serif","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"middle"},{"text":"Votos","x":-0.059068112066091,"y":0.5,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgb(0,0,0)","family":"serif","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-90,"xanchor":"center","yanchor":"middle"}],"yaxis":{"type":"linear","autorange":false,"tickmode":"array","range":[-4.7,98.7],"ticktext":["0","25","50","75"],"tickvals":[0,25,50,75],"ticks":"outside","tickcolor":"rgb(0,0,0)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgb(0,0,0)","family":"serif","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"domain":[0,1],"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgb(0,0,0)","family":"serif","size":11.689497716895},"y":1},"barmode":"stack","hovermode":"closest"},"source":"A","config":{"modeBarButtonsToRemove":["sendDataToCloud"]},"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
    <script type="application/htmlwidget-sizing" data-for="htmlwidget-9129">{"viewer":{"width":450,"height":350,"padding":5,"fill":true},"browser":{"width":960,"height":500,"padding":5,"fill":true}}</script>
    
  </head>
  
  <body>
    
    <div class="reveal">

		  <!-- Any section element inside of this container is displayed as a slide -->
      <div class="slides">

	<section>
	  
	  <section>
	    <h1>Curso: Análisis y visualización de datos</h1>
	    <h2><code><a href='http://sl.ugr.es/bigdata'>sl.ugr.es/bigdata</a></code></h2>
	  </section>

	  <section>
	    <h1>Lo que veremos</h1>
	    <ol>
	      <li>Principios de visualización de datos</li>
	      <li>Una gramática para gráficos: <code>ggplot2</code></li>
	      <li>Creando informes automáticamente</li>
	      <li>Usando herramientas online de visualización</li>
	    </ol>
	  </section>

	  <section>
	    <h1>En el principio, fue la visualización</h1>
	    <aside class='notes'>Un análisis de datos empieza por la visualización de los mismos, porque el sistema visual humano es capaz de encontrar relaciones entre ellos e incluso sacar conclusiones. A partir de la visualización se puede empezar a pensar en aplicar otras técnicas de preprocesamiento, estadísticas y de reconocimiento de patrones</aside>
	  </section>
	</section>

	<section>

	  
	    <section><h1>Visualizando datos con principios</h1></section>
	    
	    <section>
	      <h1>Tufte: <a href='http://thedoublethink.com/2009/08/tufte%E2%80%99s-principles-for-visualizing-quantitative-information/'>principios para visualización de datos</a></h1>
	      
	      <aside class='notes'>Propuesto a principios de los 80. Y todavía están vigentes y cada vez
		se toman más en
		serio. En <a href='http://www2.cs.uregina.ca/~rbm/cs100/notes/spreadsheets/tufte_paper.html'>este
		  artículo</a> muestran también una serie de principios,
		más extensivamente. Este <a href='https://porganized.com/2012/10/02/the-visual-display-of-quantitative-information/'>artículo</a> muestra algunos ejemplos.</aside>
	    </section>
	    
	    <section>
	      <h1>Integridad</h1>
	    </section>
	    
	    <section>
	      <h1>Tasa datos/tinta alta</h1>
	      <aside class='notes'>El <a href='http://www.infovis-wiki.net/index.php/Data-Ink_Ratio'>Data-Ink ratio</a> se refiere a la relación entre la "tinta" o "non-background pixels" totales y el resto de lo que hay en el gráfico: etiquetas, ejes, ese tipo de cosas. Maximizarla implica eliminar todo lo que es superfluo, dejando sólo la información que se quiere transmitir.</aside>
	    </section>
	    
	    <section>
	      <h1>Eliminación de <em>chartjunk</em>
	      </h1>
	    </section>
	    
	    <section><h1>Alta densidad de datos.</h1>
	      <aside class='notes'>
	    </section>

	</section> <!-- termina intro -->

	<section>
	  <section>
	    <h1><code>ggplot2</code></h1>
	    
	    <h2>Una <em>gramática para gráficos</em> que facilita las presentaciones.</h2>
	  </section>

	  <section><h2><pre><code>&gt; install.packages("ggplot2")</code></pre></h2></section>

	  <section><h1>Datos: Elecciones UGR</h1>
	    <code><a href='http://opendata.ugr.es/dataset/resultados-elecciones'><code>sl.ugr.es/bdw_1</code></a></code>
	  </section>

	  <section>
	    <h3><a href='R/qplot.R'><code>R/qplot.R</code></a></h3>
	    <pre><code>library(ggplot2)
elecciones <- read.csv('../data/resultadoselecciones2015.csv')
qplot(elecciones$Sector, elecciones$Votos,
    color=elecciones$Candidato)
qplot(elecciones$Sector, elecciones$Votos,
    color=elecciones$Candidato,size=elecciones$Votos)</code></pre>

	  </section>

	  <section>
	    <img src='R/qplot.png' title='Resultado qplot'>
	    <p><strong>Ejercicio</strong>: 
	      Reproducir estos resultados con  eje x el candidato y el sector con el color.</p>
	  </section>

	  <section>
	    <pre><code>qplot(data=elecciones, x=Sector, y=Votos,
    geom="bar",stat="identity", fill=Candidato)
ggsave("qplot-bar.png")</code></pre>
	    <img src='R/qplot-bar.png' alt='info en barras'>
	  </section>

	  <section>
	    <h1>Ejercicio</h1> 
	      <p>Reproducir los resultados anteriores usando como eje x el candidato y el sector para el relleno.</p>
	  </section>

	  <section>
	    <pre><code>qplot(data=elecciones, x=Sector, y=Votos,
    geom="bar",stat="identity", fill=Candidato, 
    facets=Candidato~Sector)</code></pre>
	    <img src='R/qplot-bar-facets.png' alt='info en facetas'>
	  </section>

	  <section>
	    <h1>Ejercicio</h1> 
	      <p>Reproducir los resultados anteriores usando como eje x el candidato y el sector para el relleno.</p>
	  </section>

	  <section>
	    <h1>Ejercicio</h1> 
	    <p>Usar los <a href='http://sl.ugr.es/bdw_2'>datos de matrículas de la UGR <code>sl.ugr.es/bdw_2</code></a> para realizar la representación más adecuada según la naturaleza de los mismos. </p>
	  </section>

	</section>

	<section>
	  <section>
	    <h1>R-Markdown</h1>

	    <h2>Creando informes dinámicos con R y <em>MarkDown</em></h2>
	  </section>

	  <section>
	    <h1>Markdown es un lenguaje simple de marcas</h1>
	  </section>
	  <section>
	    <pre><code>#Resultados de investigación

## Introducción

Datos extraidos de [este fichero](R/datos.csv), 
correspondientes al **año 2014**
	    </code></pre>
	  </section>

	  <section>
	    <pre><code>Importante:
1. Publicaciones aumentan
2. Se publica en las revistas más importantes
2. Somos guay.
Causas probables:
- Trabajamos demasiado.
- Publica o perece</code></pre>
	  </section>

	  <section>
	    <h1>RStudio → Knit HTML</h1>
	  </section>

	  <section><h1>Resultados de investigación</h1>
	    <div id="introduccion" class="section level2">
  <h2>Introducción</h2>
  <p>Datos extraidos de <a href="data/datos.csv">este fichero</a>, correspondientes al <strong>año 2014</strong></p>
  <p>Importante:</p>
<ol style="list-style-type: decimal">
  <li>Publicaciones aumentan</li>
<li>Se publica en las revistas más importantes</li>
<li>Somos guay.</li>
</ol>
<p>Causas probables:</p>
<ul>
  <li>Trabajamos demasiado.</li>
  <li>Publica o perece</li>
</ul></div></section>

	   <section>
	    <h1>Ejercicio</h1> 
	    <p>Realizar un breve informe en markdown explicando los gráficos realizados anteriormente. Compilar markdown usando RStudio. Consultar <a href='https://daringfireball.net/projects/markdown/syntax'>la sintaxis completa en este documento</a> o en la ayuda de Rstudio. </p>
	  </section>
	  
	</section>

	<section>
	  <section>
	    <h2>Ahora todo junto</h2>
	    <h1 class='fragment'>R Markdown, código y texto</h1>
	  </section>

	  <section>
	    <pre><code>---
title: "datos-investigacion"
author: "JJ Merelo"
date: "26/11/2015"
output: html_document
---
#Resultados de investigación

```{r}
investigacion.UGR <- read.csv('../data/estadisticasbasicastodas.csv')
```</code></pre>
	  <img src='img/rmarkdown.png' data='resultado rmarkdown'>
	</section>

	<section><pre><code>## Publicaciones
```{r, echo=FALSE, message=FALSE,results='hide',warning=FALSE}
library(ggplot2)
library(reshape2)
publicaciones.UGR 
    <- investigacion.UGR[investigacion.UGR$Tipo.de.Estadística=="Publicaciones ISI",]
publicaciones.UGR.year 
    <- melt(publicaciones.UGR,id.vars=1:2,variable.name="year")
pubs.WOS 
    <- publicaciones.UGR.year[publicaciones.UGR.year$Denominación 
        == "No. pub. WoS (Thomson)",]
pubs.WOS$value <- as.integer(pubs.WOS$value)
qplot(data=pubs.WOS,x=year,y=value)
```</code></pre></section>
	<section><img src='img/rmarkdown-2.png' alt='con gráfico'></section>

	  <section>
	    <h1>Ejercicio</h1> 
	    <p>Completar el informe anterior incluyendo los datos, su tratamiento y presentación en HTML y PDF. Trazar, por ejemplo, el <em>número de trabajos con factor de impacto mayor que 10</em> </p>
	  </section>
	</section>

	<section>
	  <section><h1><code>ggplot</code></h1>

	    <pre><code>ggplot() + geom_point(data=pubs.WOS, aes(x=year, y=value))</code></pre>
	  </section>

	  <section><h1><code>+</code> combina gráficos</h1></section>

	  <section><pre><code>ggplot()
    +geom_point(data=pubs.WOS,
       aes(x=year,y=value,color='Todas'))
    +geom_point(data=pubs.WOS.citables,
       aes(x=year,y=value,color='Citables'))</code></pre>
	  </section>

	  <section>
	    <img src='img/ggplot.png' alt='Con ggplot'>
	  </section>

	  <section>
	    <h1>Ejercicio</h1> 
	    <p>Igual que en el caso anterior, continuar el informe RMarkdown combinando diferentes gráficos usando <code>ggplot</code> </p>
	  </section>

	  <section>
	    <h2>Cambiando colores, ejes, títulos... </h2>
	    <code><a href='http://docs.ggplot2.org/current/'>docs.ggplot2.org/current/</a></code>
	  </section>

	   <section>
	    <h1>Ejercicio</h1> 
	    <p>Combinar diferentes elementos gráficos hasta dar con un gráfico satisfactorio: títulos, leyendas... Incluirlo en el informe escrito en RMarkdown</p>
	  </section>

	   <section>
	     <h1><code>ggthemes</code>: Tufte (y más) para <code>ggplot</code></h1>
	   </section>

	    <section>
	    <h1>Ejercicio</h1> 
	    <p>Instalar ggthemes y usarlo para una nueva
	    representación de los datos anteriores, especialmente el
	    tema Tufte.</p>
	  </section>
	</section>

	<section>
	  <section><h1>Usando Plotly para generar gráficos JS</h1>
	  </section>
	  
	  <section><pre><code>votos.claustro <- read.csv("../data/claustro.csv")
votos.plot <- ggplot()
	      +geom_bar(data=votos.claustro,
	                aes(x=reorder(Nombre,-Votos),y=Votos,fill=Votos),stat='identity')
	      +theme_tufte()
	      +theme(axi s.text.x = element_text(angle = 90, hjust = 1)) </pre> </code>

	      <pre><code class='fragment'>plot_ly(votos.plot)</code></pre>
	  </section>

	  <section  id="htmlwidget-9129" class="plotly html-widget"></section>
		</section>

	
	<section>
	  <h1>Publicando en RPubs</h1>
	</section>
	
	<section>
	  <h1><code>knitr</code>: LaTeX + R</h1>
	</section>

	<section>
	  <section>
	    <h1>Google Fusion Tables</h1>
	  </section>

	  <section>
	    <h1>Google Drive → Añadir Google Fusion Tables</h1>
	  </section>

	  <section><h1>Ejercicio</h1>
	    <p>Tomar <a href='data/data-per-province.csv'>datos provinciales de usuarios de GitHub</a> y crear una tabla dinámica en GFT. Filtrar por población y representar el número de contribuciones ordenadas.</p>
	  </section>
	</section>

	  <section>
	    <section>
	      <h1>Representación cartográfica: CartoDB</h1>

	      <h2>Herramienta flexible de presentación en mapas</h2>
	    </section>

	    <section>
	      <h1>Información topográfica o coordenadas</h1>
	      <h2 class='fragment'>Ciudad, provincia, calles...</h2>
	    </section>

	    <section>
	      <h1><em>Capas</em> de información</h1>

	      <h2>Con diferente grado de transparencia</h2>
	    </section>
	    
	    <section><h1>Ejercicio</h1>
	      <p>Tomar <a href='data/data-per-province.csv'>datos provinciales de usuarios de GitHub</a> y crear capas con diferentes cantidades. Mirar diferencias provinciales y experimentar con diferentes bases.</p>
	  </section>
	    
	</section>
      </div>
	      
      
      </div>
      
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>

			// Full list of configuration options available at:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
			controls: true,
			progress: true,
			history: true,
			center: true,
			width: 1200,
			height: 800,
			transition: 'slide', // none/fade/slide/convex/concave/zoom

				// Optional reveal.js plugins
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true },
					{ src: 'plugin/notes/notes.js', async: true }
				]
			});

		</script>

	</body>
</html>
